//set up two way data binding for saasy
var saasy = angular.module('saasy-app', []);

saasy.directive('saasycontent', function() {
      function getInstances() {
        for(name in CKEDITOR.instances) {
            if (CKEDITOR.instances.hasOwnProperty(name)) {
                CKEDITOR.instances[name].on('pasteState', function() {
                    alert(this);
                });
            }
        }
      }
      var instances = getInstances();
      return {
        restrict: 'A', // only activate on element attribute
        require: '?ngModel', // get a hold of NgModelController
        link: function(scope, element, attrs, ngModel) {
          if(!ngModel) return; // do nothing if no ng-model

          // Specify how UI should be updated
          ngModel.$render = function() {
            element.html(ngModel.$viewValue || '');
          };
          if(!instances) {
            isntances = getInstances();
          }
          if(instances) {
            debugger;
          }
          // Listen for change events to enable binding
          element.bind('blur keyup change', function() {
            scope.$apply(read);
          });
          read(); // initialize

          // Write data to the model
          function read() {
            ngModel.$setViewValue(element.html());
          }
      }
    };
});

angular.element(document).ready(function() {
    angular.bootstrap(document, ['saasy-app']);
});

